<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type="text/xml" href="http://icanteden.com/redeux//feed.xslt.xml"?><feed xmlns="http://www.w3.org/2005/Atom"><generator uri="http://jekyllrb.com" version="3.3.1">Jekyll</generator><link href="http://icanteden.com/redeux//feed.xml" rel="self" type="application/atom+xml" /><link href="http://icanteden.com/redeux//" rel="alternate" type="text/html" /><updated>2016-12-19T16:39:49-05:00</updated><id>http://icanteden.com/redeux///</id><title type="html">Michael’s Weird Blog</title><subtitle>Author Michael Eden (engineer) experiments with the idea of having a creative outlet. Watch him fall back on his crutch by writing about cool tech and read his strange writing, the only guarantee is that the content is wholly his own.
</subtitle><entry><title type="html">Improv Stories I</title><link href="http://icanteden.com/redeux//2016/11/30/improv-stories-one/" rel="alternate" type="text/html" title="Improv Stories I" /><published>2016-11-30T00:00:00-05:00</published><updated>2016-11-30T00:00:00-05:00</updated><id>http://icanteden.com/redeux//2016/11/30/improv-stories-one</id><content type="html" xml:base="http://icanteden.com/redeux//2016/11/30/improv-stories-one/">&lt;p&gt;Janie and I often write the invitations for my friends’ house parties.
In order to get in the creative mood, we write some improvised stories
as an excercise. This is a collection of some of the better stories from
that excercise.&lt;/p&gt;

&lt;h1 id=&quot;1&quot;&gt;1&lt;/h1&gt;

&lt;p&gt;Michael regains consciousness only to realize he is still at CVS with
Janie.
“This is a dream &lt;del&gt;come true&lt;/del&gt;, I’ve dreamed this before.”&lt;/p&gt;

&lt;p&gt;“I don’t think they have my color” Janie said wistfully.&lt;/p&gt;

&lt;p&gt;Michael followed his previous dreams to the letter, maybe this time
he wouldn’t have to fight homeless zombies using self help books.
Janie begins to leave and Michael eagerly follows.&lt;/p&gt;

&lt;p&gt;“Is this it? I never found out what happens when I leave the CVS!”&lt;/p&gt;

&lt;p&gt;As they exit Michael pleads “Slap me I must be dreaming!”.&lt;/p&gt;

&lt;p&gt;Michael does not wake up, he remains awake and slapped.&lt;/p&gt;

&lt;h1 id=&quot;2&quot;&gt;2&lt;/h1&gt;

&lt;p&gt;A nondescript man sneaks into the “gogurt-geiser”, the place for all
dani-manufacturing. He slides a discrete splooge-bomb into the
factory core reactor, then slides out like a well made gogurt.&lt;/p&gt;

&lt;p&gt;“Oh god, oh jeez… Gogurts have gone bankrupt from a huge ‘gurt
splooge spill?” Dr. Glockenload had paced through his lab twice over.&lt;/p&gt;

&lt;p&gt;“Surely mother nature will pay, I must undo this horrible disaster!”&lt;/p&gt;

&lt;p&gt;Dr. Glockenload constructs a tiny time machine that can only travel
through a tiny amount of time. It’ll be enough, it has to be.
Squeezing himself inside like a gogurt in reverse, he travels to the
gogurt factory fifteen minutes before the spill.&lt;/p&gt;

&lt;p&gt;“I’m Brilliant!” Dr. Glockenload is feeling well.&lt;/p&gt;

&lt;p&gt;After sneaking through most of the complex he finds the bomb.
Immediately attempting to disarm it, Dr. Glockenload finds a note
contained within. It reads: “Contained is the motivation for a brilliant invention”.
Dr. Glockenload opens a gogurt he knows will be his last,&lt;/p&gt;

&lt;p&gt;“what is the price we must pay for science?” he whispers.&lt;/p&gt;

&lt;h1 id=&quot;3&quot;&gt;3&lt;/h1&gt;

&lt;p&gt;“Here we are folks, at the annual top cutie competition, and man have
we got some bangin’ competition. First up is Michael Eden!”&lt;/p&gt;

&lt;p&gt;Michael Eden walks onto stage pretty normally, to uproarious
applause. Extreme catcalling can be heard from right in front of him,
where his girlfriend stands possessively. She is blocking him from
the sight of most, if not all women in the audience.&lt;/p&gt;

&lt;h1 id=&quot;4&quot;&gt;4&lt;/h1&gt;

&lt;p&gt;“This just in, a &lt;em&gt;space&lt;/em&gt; bear that feeds off solar energy and can
travel through space has been discovered. Upon landing on Earth the
bear had this to say—”&lt;/p&gt;

&lt;p&gt;“Sorry Wolf I’m gonna have to stop you right there we have breaking
news. Get this, a &lt;em&gt;space&lt;/em&gt; hole has appeared in central florida, marking
the first time any hole has reached outer space. Florida is known for
its holes and—”&lt;/p&gt;

&lt;p&gt;“Sorry Anderson, but a cat of news has &lt;em&gt;just&lt;/em&gt; now been let out of its
bag. Moneybags and Amazon founder Jeff Bezos said in a statement
today that after a lot of frustration he will create the first good
24 hour news channel.”&lt;/p&gt;

&lt;p&gt;“Sorry Don, we’ll have to leave it there. If you’re just joining us
there has been a lot of news that you missed. After the break: we get
a lineup of labrador retrievers and ask everyday people ‘can &lt;em&gt;you&lt;/em&gt; tell
which one is evil?’.”&lt;/p&gt;

&lt;h1 id=&quot;5&quot;&gt;5&lt;/h1&gt;

&lt;p&gt;Janie’s hands followed the trail of hair leading to Michael’s
erection. She grabs it in her hands, only to realize that it’s the
kind of cock that bursts into confetti. The rest of Michael’s body
follows suit.
Sitting in a heap of colourful paper shreds, Janie begins to paper
mache herself a new boyfriend.&lt;/p&gt;

&lt;p&gt;He will be stickier this time, and unable to burst into confetti.&lt;/p&gt;

&lt;h1 id=&quot;6&quot;&gt;6&lt;/h1&gt;

&lt;p&gt;“Get gud or get rekt,” Michael whispers, cradling Janie’s unconscious
form with his super hot biceps and other arm stuff. He had just moved
his knight to B7, taking out all of her castles, bishops, and her
queen with the one splendid move. He very near took her life.
Her eyes fluttered open. Michael considers making the joke that he
couldn’t tell that her eyes opened. [He very near took his own life.]&lt;/p&gt;

&lt;p&gt;“Checkm8 atheists,” she mouthed.&lt;/p&gt;

&lt;p&gt;“W-what?!”&lt;/p&gt;

&lt;p&gt;With an incredible move, Janie puts the last pawn in place. An
infinitude of pawns line diagonally to Michael’s king.&lt;/p&gt;

&lt;p&gt;“Now that’s what I call pawn-ography.” She gives him a kiss and a slap on the ass.&lt;/p&gt;

&lt;p&gt;“Not so fast, chum.” Michael kneels over the chessboard,
king pieces sliding saliva-coated out of his mouth and onto the board.
He wipes the spit off with a shirt sleeve:&lt;/p&gt;

&lt;p&gt;“U’ve been playing checkers while i’ve been playing chess for years”&lt;/p&gt;</content><category term="funny" /><category term="prose" /><summary type="html">Janie and I often write the invitations for my friends’ house parties.
In order to get in the creative mood, we write some improvised stories
as an excercise. This is a collection of some of the better stories from
that excercise.</summary></entry><entry><title type="html">Wifi Sharing in Kali Linux</title><link href="http://icanteden.com/redeux//2014/08/07/wifi-sharing-kali/" rel="alternate" type="text/html" title="Wifi Sharing in Kali Linux" /><published>2014-08-07T00:00:00-04:00</published><updated>2014-08-07T00:00:00-04:00</updated><id>http://icanteden.com/redeux//2014/08/07/wifi-sharing-kali</id><content type="html" xml:base="http://icanteden.com/redeux//2014/08/07/wifi-sharing-kali/">&lt;h1 id=&quot;intro&quot;&gt;Intro&lt;/h1&gt;

&lt;p&gt;I have spent a long long while looking for solutions to this problem over the great Linux forums, and in truth its not easy to do. Most of the scripts I’ve come across did not work, but from all this experience I’ve pieced together a collection of DHCPD rules and iptable commands that should allow you to use airbase-ng to create a WiFi hotspot with optional WEP Encryption.&lt;/p&gt;

&lt;p&gt;So here it is.&lt;/p&gt;

&lt;h1 id=&quot;prerequisites&quot;&gt;Prerequisites&lt;/h1&gt;

&lt;p&gt;In order to have this script run successfully you will need:&lt;/p&gt;

&lt;h2 id=&quot;the-hardware&quot;&gt;The Hardware&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;A wireless card or Ethernet card that is connected to the Internet.&lt;/li&gt;
  &lt;li&gt;Another wireless card that can be put into monitor mode&lt;/li&gt;
  &lt;li&gt;Some computer with Linux (Why not Kali Linux?)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;the-software&quot;&gt;The Software&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;aircrack-ng&lt;/code&gt; suite, notably &lt;code class=&quot;highlighter-rouge&quot;&gt;airbase-ng&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mitmproxy&lt;/code&gt; available by issuing &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo pip2 install mitmproxy&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;dhcpd&lt;/code&gt; which is not available in Kali by default and
one can install it through &lt;code class=&quot;highlighter-rouge&quot;&gt;apt-get install isc-dhcp-server&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;the-script&quot;&gt;The Script&lt;/h1&gt;

&lt;h2 id=&quot;variable-names&quot;&gt;Variable Names&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;LAN_IF&lt;/code&gt; is the interface connected to the Internet.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;LAN_GATEWAY&lt;/code&gt; is the IP of the main router to which &lt;code class=&quot;highlighter-rouge&quot;&gt;LAN_IF&lt;/code&gt; connects to.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AP_IF&lt;/code&gt; is the monitor mode capable interface.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AP_CHANNEL&lt;/code&gt; specifies the wireless channel of the AP.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AP_ESSID&lt;/code&gt; is the AP name.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AP_GATEWAY&lt;/code&gt; is the router IP clients connected to the AP will see.&lt;/li&gt;
  &lt;li&gt;For a range of IPs of &lt;code class=&quot;highlighter-rouge&quot;&gt;AP_RANGE&lt;/code&gt; given to the clients, &lt;code class=&quot;highlighter-rouge&quot;&gt;AP_SUBNET&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;AP_NETMASK&lt;/code&gt; should stay the same.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;AP_MTU&lt;/code&gt; is the &lt;a href=&quot;https://en.wikipedia.org/wiki/Maximum_transmission_unit&quot;&gt;MTU&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;Finally &lt;code class=&quot;highlighter-rouge&quot;&gt;MITMPROXY_FLAGS&lt;/code&gt; are the arguments that get appended on to mitmproxy at runtime.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Change these arguments to fit your needs. Also if you want WPA/WPA2 encryption, use hostapd with a suitable Atheros wireless card.&lt;/p&gt;

&lt;h2 id=&quot;the-entire-script&quot;&gt;The Entire Script&lt;/h2&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;LAN_IF&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;wlan1
&lt;span class=&quot;nv&quot;&gt;LAN_GATEWAY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;ip -4 route list &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;unicast dev &lt;span class=&quot;nv&quot;&gt;$LAN_IF&lt;/span&gt; exact 0/0 | cut -d &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; -f 3&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;AP_IF&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;wlan0
&lt;span class=&quot;nv&quot;&gt;AP_CHANNEL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;6
&lt;span class=&quot;nv&quot;&gt;AP_ESSID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Do not connect to'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;AP_GATEWAY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'192.168.2.1'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;AP_SUBNET&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'192.168.2.0'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;AP_NETMASK&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'255.255.255.0'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;AP_RANGE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'192.168.2.2 192.168.2.255'&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;AP_MTU&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1400

&lt;span class=&quot;nv&quot;&gt;MITMPROXY_FLAGS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#MITMPROXY_FLAGS=&quot;-s /root/Desktop/image_local.py&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;id -u&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; !&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;0&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Run it as root.&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;1
&lt;span class=&quot;k&quot;&gt;fi

&lt;/span&gt;ifconfig &lt;span class=&quot;nv&quot;&gt;$AP_IF&lt;/span&gt; down
iwconfig &lt;span class=&quot;nv&quot;&gt;$AP_IF&lt;/span&gt; mode monitor channel &lt;span class=&quot;nv&quot;&gt;$AP_CHANNEL&lt;/span&gt;
ifconfig &lt;span class=&quot;nv&quot;&gt;$AP_IF&lt;/span&gt; up

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;iwconfig &lt;span class=&quot;nv&quot;&gt;$AP_IF&lt;/span&gt; | grep -o Mode:Monitor&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[FAIL] Could not put interface &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AP_IF&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; in monitor mode.&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;       Exiting...&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;exit
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[ OK ] monitor mode on interface &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AP_IF&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;
    sleep 1
&lt;span class=&quot;k&quot;&gt;fi

&lt;/span&gt;xterm -geometry 75x15+1+0 -T &lt;span class=&quot;s2&quot;&gt;&quot;Airbase - &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AP_ESSID&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; - &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AP_IF&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
       -e &lt;span class=&quot;s2&quot;&gt;&quot;airbase-ng -c &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AP_CHANNEL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -e '&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AP_ESSID&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;' &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AP_IF&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &amp;amp;
&lt;span class=&quot;nv&quot;&gt;AIRBASE_PID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$!&lt;/span&gt;
sleep 3

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;ps -A | grep -o &lt;span class=&quot;nv&quot;&gt;$AIRBASE_PID&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[FAIL] Cannot find airbase-ng, quitting.&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;exit
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[ OK ] Started airbase-ng&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi

&lt;/span&gt;ifconfig lo up
ifconfig at0 up
sleep 1
ifconfig at0 &lt;span class=&quot;nv&quot;&gt;$AP_GATEWAY&lt;/span&gt; netmask &lt;span class=&quot;nv&quot;&gt;$AP_NETMASK&lt;/span&gt;
ifconfig at0 mtu &lt;span class=&quot;nv&quot;&gt;$AP_MTU&lt;/span&gt;
route add -net &lt;span class=&quot;nv&quot;&gt;$AP_SUBNET&lt;/span&gt; netmask &lt;span class=&quot;nv&quot;&gt;$AP_NETMASK&lt;/span&gt; gw &lt;span class=&quot;nv&quot;&gt;$AP_GATEWAY&lt;/span&gt;

iptables --flush
iptables --table nat --flush
iptables --delete-chain
iptables --table nat --delete-chain

&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;1 &amp;gt; /proc/sys/net/ipv4/ip_forward

iptables -t nat -A PREROUTING -p udp -j DNAT --to &lt;span class=&quot;nv&quot;&gt;$LAN_GATEWAY&lt;/span&gt;
iptables -P FORWARD ACCEPT
iptables --append FORWARD --in-interface at0 -j ACCEPT
iptables --table nat --append POSTROUTING --out-interface &lt;span class=&quot;nv&quot;&gt;$LAN_IF&lt;/span&gt; -j MASQUERADE
iptables -t nat -A PREROUTING -p tcp --destination-port 80 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
         -j REDIRECT --to-port 8080

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[ OK ] IP table rules set.&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;authoritative;

default-lease-time 600;
max-lease-time 7200;

subnet &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AP_SUBNET&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; netmask &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AP_NETMASK&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; {
    option routers &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AP_GATEWAY&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;;
    option subnet-mask &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AP_NETMASK&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;;
    option domain-name &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AP_ESSID&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;;
    option domain-name-servers &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$LAN_GATEWAY&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;;
    range &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AP_RANGE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;;
}
&quot;&lt;/span&gt; &amp;gt; /etc/dhcpd-rogue.conf

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[ OK ] Adding DHCPD configuration.&quot;&lt;/span&gt;

touch /var/run/dhcpd.pid
xterm -geometry 75x20+1+100 -T DHCP &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
      -e dhcpd -d -f -cf &lt;span class=&quot;s2&quot;&gt;&quot;/etc/dhcpd-rogue.conf&quot;&lt;/span&gt; -pf &lt;span class=&quot;s2&quot;&gt;&quot;/var/run/dhcpd.pid&quot;&lt;/span&gt; at0 &amp;amp;
&lt;span class=&quot;nv&quot;&gt;DHCPD_PID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$!&lt;/span&gt;
sleep 3

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt; -ne 0 &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[FAIL] DHCPD Failed to start.&quot;&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;exit
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;[ OK ] Started DHCPD Server&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi

&lt;/span&gt;mitmproxy -T --host --anticache -p 8080 &lt;span class=&quot;nv&quot;&gt;$MITMPROXY_FLAGS&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#echo &quot;Hit Enter to tear down the network.&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#read&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Cleaning up...&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;kill&lt;/span&gt; -SIGINT &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;cat /var/run/dhcpd.pid&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;kill&lt;/span&gt; -SIGINT &lt;span class=&quot;nv&quot;&gt;$AIRBASE_PID&lt;/span&gt;

ifconfig &lt;span class=&quot;nv&quot;&gt;$AP_IF&lt;/span&gt; down
iwconfig &lt;span class=&quot;nv&quot;&gt;$AP_IF&lt;/span&gt; mode managed
ifconfig &lt;span class=&quot;nv&quot;&gt;$AP_IF&lt;/span&gt; up

&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;0 &amp;gt; /proc/sys/net/ipv4/ip_forward
iptables --flush
iptables --table nat --flush
iptables --delete-chain
iptables --table nat --delete-chain

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Done.&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;This had worked for me in Kali Linux when this post was published, so please comment if anything stops working.&lt;/p&gt;</content><category term="linux" /><summary type="html">Intro</summary></entry><entry><title type="html">Bitshifts &amp;amp; Safetybelts</title><link href="http://icanteden.com/redeux//2014/08/04/steganography/" rel="alternate" type="text/html" title="Bitshifts &amp; Safetybelts" /><published>2014-08-04T00:00:00-04:00</published><updated>2014-08-04T00:00:00-04:00</updated><id>http://icanteden.com/redeux//2014/08/04/steganography</id><content type="html" xml:base="http://icanteden.com/redeux//2014/08/04/steganography/">&lt;h1 id=&quot;the-steganographic-way&quot;&gt;The Steganographic Way&lt;/h1&gt;

&lt;p&gt;Look at this picture of Andy, do you see a hidden message?&lt;/p&gt;

&lt;div class=&quot;article-img&quot;&gt;
    &lt;div class=&quot;center&quot;&gt;
    &lt;a href=&quot;/redeux//media/2014-08-04-stickshifts-n-safetybelts/andy-encoded.png&quot; target=&quot;_blank&quot;&gt;
        &lt;img src=&quot;/redeux//media/2014-08-04-stickshifts-n-safetybelts/andy-encoded.png&quot; alt=&quot;The text 'Hello World!' is encoded into this image.&quot; /&gt;
    &lt;/a&gt;
    &lt;/div&gt;
    
    &lt;blockquote style=&quot;border-left: 10px solid #D5D5D5;&quot;&gt;The text 'Hello World!' is encoded into this image.&lt;/blockquote&gt;
    
&lt;/div&gt;

&lt;p&gt;‘Hello World!’ is able to live inside that image using one common method of Steganography:
&lt;a href=&quot;https://en.wikipedia.org/wiki/Steganography&quot;&gt;“the art or practice of concealing a message, image, or file within another message, image, or file”&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;To visualize this hiding we first transform the message into binary (using Unicode):&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;        &lt;span class=&quot;n&quot;&gt;H&lt;/span&gt;                       &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;
&lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0100&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;     &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0110&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0101&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;                       &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;
&lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0110&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1100&lt;/span&gt;     &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0110&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1100&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;o&lt;/span&gt;                       &lt;span class=&quot;n&quot;&gt;space&lt;/span&gt;
&lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0110&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1111&lt;/span&gt;     &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0010&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;W&lt;/span&gt;                       &lt;span class=&quot;n&quot;&gt;o&lt;/span&gt;
&lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0101&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0111&lt;/span&gt;     &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0110&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1111&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;                       &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;
&lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0111&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0010&lt;/span&gt;     &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0110&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1100&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;                       &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;
&lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0110&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0100&lt;/span&gt;     &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0000&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0010&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;0001&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;The idea here is to take all the bits and place each of them on one pixel of the image. Since there are 192 bits (count them!) we will need a image file that is at least 192 pixels. Good thing our picture of Andy is 496 x 274 = 135904 pixels! This gives you an idea of exactly how much you can fit into Andy.&lt;/p&gt;

&lt;p&gt;So where in the pixel do we put this bit?? Well each pixel in an image must be a fixed number of bits long (so computers can read the image correctly), so we cannot just squeeze this bit in between the bits of the pixel. No, the only other option is to&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Pick a bit in the pixel&lt;/li&gt;
  &lt;li&gt;Remove this bit&lt;/li&gt;
  &lt;li&gt;Replace it with a bit from the message&lt;/li&gt;
  &lt;li&gt;Repeat until all message bits are in pixels&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;To change the color of the pixel the least (to make our efforts the more inconspicuous) we are going to peel of the LSB (least significant bit) from the image. Here’s a visual:&lt;/p&gt;

&lt;table&gt;
&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;Before&lt;/td&gt;&lt;td&gt;After&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Replacing the most significant bit (left most)&lt;/td&gt;
&lt;td style=&quot;background-color:#0000FF;font-family:monospace;color:white;&quot;&gt;000000000000000011111111&lt;/td&gt;
&lt;td style=&quot;background-color:#8000FF;font-family:monospace;color:white;&quot;&gt;100000000000000011111111&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Replacing the least significant bit (right most)&lt;/td&gt;
&lt;td style=&quot;background-color:#0000FF;font-family:monospace;color:white;&quot;&gt;000000000000000011111111&lt;/td&gt;
&lt;td style=&quot;background-color:#0000FE;font-family:monospace;color:white;&quot;&gt;000000000000000011111110&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

&lt;p&gt;Of course there is a 50% chance that the bit we remove and the bit we replace will coincidentally be the same. In this case literally nothing is changed for that pixel.&lt;/p&gt;

&lt;h1 id=&quot;the-code&quot;&gt;The Code&lt;/h1&gt;

&lt;p&gt;I’ve, after learning about this method, written a program to automate the process. In it though I have reserved the first 32 pixels to tell the program how long the message is so it will know how much of the image to decode.&lt;/p&gt;

&lt;p&gt;Written in C++ &amp;amp; Qt, the code starts by creating a copy of the image so the copy can be changed and encoded. It then initializes x and y, which represent the coordinates of the image: (0, 0) means top left. Finally it gets the message length to encode into the first 32 pixels of the image.&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;QImage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Cipher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encodeImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;QImage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encodedImage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;QImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()));&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bitsPerPixel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encodedImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;then we have this ugly thing:&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;This loop initializes &lt;code class=&quot;highlighter-rouge&quot;&gt;mask&lt;/code&gt; to equal 1. Then each pass of the loop shifts all the bits in mask to the left then saves that value back to mask. A quick reminder on what left bit shift is:&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;//      mask = 0 ...23 0's... 0000 0001
&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// Shift all bits one to the left, then save it in 'mask'
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//      mask = 0 ...23 0's... 0000 0010
&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// Shift again
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//      mask = 0 ...23 0's... 0000 0100
&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// and so on. until that lone '1' is shifted all
// the way to the end (left), after that it is simply
// shifted out of existence. Then only 0's are left.
&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// When this happens
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;// is true and the loop exits
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;This loop generates a variable (&lt;code class=&quot;highlighter-rouge&quot;&gt;mask&lt;/code&gt;) that will only contain ‘0’s except for one ‘1’,
this ‘1’ will also be in every location on the variable only once. This is great news.&lt;/p&gt;

&lt;p&gt;Basically the location of the ‘1’ in &lt;code class=&quot;highlighter-rouge&quot;&gt;mask&lt;/code&gt; decides which bit of &lt;code class=&quot;highlighter-rouge&quot;&gt;header&lt;/code&gt; to use.&lt;/p&gt;

&lt;div class=&quot;message&quot;&gt;This first loop encodes the &lt;code&gt;header&lt;/code&gt; variable
into the image which is a lot like encoding the actual message,
this is done in the second loop. &lt;code&gt;header&lt;/code&gt; just contains the length of the message,
which the program needs to know for later decoding.&lt;/div&gt;

&lt;p&gt;This can be done by using a bitwise AND. Bitwise AND (&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;amp;&lt;/code&gt;) takes two bits and outputs one. If both these bits are ‘1’ it will output ‘1’, otherwise the output will be ‘0’. Because &lt;code class=&quot;highlighter-rouge&quot;&gt;mask&lt;/code&gt; moves its ‘1’ along to the left, we can get each bit of header from doing &lt;code class=&quot;highlighter-rouge&quot;&gt;header &amp;amp; mask&lt;/code&gt; in this loop:&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;           &lt;span class=&quot;mo&quot;&gt;000000000001&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;010100110101&lt;/span&gt;
             &lt;span class=&quot;o&quot;&gt;---------------&lt;/span&gt;
               &lt;span class=&quot;mo&quot;&gt;000000000001&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;     &lt;span class=&quot;mo&quot;&gt;000000000010&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mo&quot;&gt;010100110101&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;---------------&lt;/span&gt;
               &lt;span class=&quot;mo&quot;&gt;000000000000&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Afterwords we want to remove the least significant bit from the pixel:&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;          &lt;span class=&quot;mi&quot;&gt;111111111110&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pixels&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;101010111001&lt;/span&gt;
             &lt;span class=&quot;o&quot;&gt;---------------&lt;/span&gt;
               &lt;span class=&quot;mi&quot;&gt;101010111000&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Then we fuse the two together with bitwise OR (&lt;code class=&quot;highlighter-rouge&quot;&gt;|&lt;/code&gt;):&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;         &lt;span class=&quot;mo&quot;&gt;000000000001&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pixel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;       &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;101010111000&lt;/span&gt;
                      &lt;span class=&quot;o&quot;&gt;---------------&lt;/span&gt;
                        &lt;span class=&quot;mi&quot;&gt;101010111001&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;div class=&quot;message&quot;&gt;Keep in mind that the binary in the examples above is actually much longer.&lt;/div&gt;

&lt;p&gt;The same thing in C++ &amp;amp; Qt:&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;n&quot;&gt;QRgb&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bit&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;QRgb&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pixel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encodedImage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pixel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x0001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;encodedImage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setPixel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pixel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Finally to keep iterating through the image left to right and top to bottom, we write this at the end of the loop:&lt;/p&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;The encoding process is mostly the same for the actual message, except now there is an outer loop that iterates through each character of the message, then an inner loop which encodes the character into 16 pixels of the image. Because the header was an &lt;code class=&quot;highlighter-rouge&quot;&gt;int&lt;/code&gt; it took up 32 bits and used 32 pixels. To make sure each character only uses 16 pixels, &lt;code class=&quot;highlighter-rouge&quot;&gt;mask&lt;/code&gt; is changed from &lt;code class=&quot;highlighter-rouge&quot;&gt;int&lt;/code&gt; to &lt;code class=&quot;highlighter-rouge&quot;&gt;ushort&lt;/code&gt;, a variable that only takes up 16 bits of space. Because a &lt;code class=&quot;highlighter-rouge&quot;&gt;ushort&lt;/code&gt; is only 16 bits long, and &lt;code class=&quot;highlighter-rouge&quot;&gt;mask&lt;/code&gt; is shifted one bit every iteration, the inner loop will run out after 16 iterations, encoding 16 pixels.&lt;/p&gt;

&lt;h2 id=&quot;the-final-code&quot;&gt;The final code:&lt;/h2&gt;

&lt;div class=&quot;language-c++ highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;QImage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Cipher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encodeImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;QImage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encodedImage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;QImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()));&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bitsPerPixel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encodedImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;QRgb&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bit&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;QRgb&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pixel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encodedImage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pixel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x0001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;encodedImage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setPixel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pixel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;QChar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;begin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ushort&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;QRgb&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bit&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;bool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unicode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;QRgb&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pixel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encodedImage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pixel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x0001&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;encodedImage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setPixel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pixel&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encodedImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encodedImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h1 id=&quot;this-is-so-meta&quot;&gt;This is so Meta&lt;/h1&gt;

&lt;p&gt;To come full circle, here is Andy again, except this time this &lt;b&gt;entire&lt;/b&gt; post is encoded into him:&lt;/p&gt;

&lt;div class=&quot;article-img&quot;&gt;
    &lt;div class=&quot;center&quot;&gt;
    &lt;a href=&quot;/redeux//media/2014-08-04-stickshifts-n-safetybelts/andy-encoded-alot.png&quot; target=&quot;_blank&quot;&gt;
        &lt;img src=&quot;/redeux//media/2014-08-04-stickshifts-n-safetybelts/andy-encoded-alot.png&quot; alt=&quot;This image contains the &amp;lt;b&amp;gt;entire&amp;lt;/b&amp;gt; post.&quot; /&gt;
    &lt;/a&gt;
    &lt;/div&gt;
    
    &lt;blockquote style=&quot;border-left: 10px solid #D5D5D5;&quot;&gt;This image contains the &lt;b&gt;entire&lt;/b&gt; post.&lt;/blockquote&gt;
    
&lt;/div&gt;</content><category term="code" /><summary type="html">The Steganographic Way</summary></entry><entry><title type="html">Heavy Duty Motion Detector: Part I</title><link href="http://icanteden.com/redeux//2014/08/01/motion-detector-one/" rel="alternate" type="text/html" title="Heavy Duty Motion Detector: Part I" /><published>2014-08-01T00:00:00-04:00</published><updated>2014-08-01T00:00:00-04:00</updated><id>http://icanteden.com/redeux//2014/08/01/motion-detector-one</id><content type="html" xml:base="http://icanteden.com/redeux//2014/08/01/motion-detector-one/">&lt;h1 id=&quot;the-idea&quot;&gt;The Idea&lt;/h1&gt;

&lt;p&gt;THE HEAVY DUTY MOTION DETECTOR can detect any human or wild animal that is not asleep, and also not strictly not asleep. The documentation isn’t written well. On motion detection it will switch on an outlet, which could power any appliance (most likely a lamp or a toaster)!&lt;/p&gt;

&lt;p&gt;I say this because it only detects infrared wavelengths of 7 to 14 nanometers (waves emitted near the human body temperature) and objects moving faster than 1 m/s.&lt;/p&gt;

&lt;p&gt;It is completely modular! So more large elements, like delays, monostables, and flip flops can be added at anytime. I’m pretty tempted to add these along with a clock circuit for a strobe light!&lt;/p&gt;

&lt;h2 id=&quot;why&quot;&gt;Why?&lt;/h2&gt;

&lt;p&gt;Long ago the light switch in my closet broke, forcing me to use the pull chain switch to bring light to my otherwise dim clothes. As I stood there in my shame pulling a string of yarn I had tied to lengthen the chain, I realized there was a better way.&lt;/p&gt;

&lt;h3 id=&quot;a-better-way&quot;&gt;A Better Way&lt;/h3&gt;

&lt;p&gt;Tying the yarn to a hook on the inside of my closet door pulled the light on as I pulled the door open.&lt;/p&gt;

&lt;p&gt;BAM! Automatic light. I though WOW. I made it.&lt;/p&gt;

&lt;h3 id=&quot;sounded-better-in-my-head&quot;&gt;Sounded Better In My Head&lt;/h3&gt;

&lt;p&gt;It didn’t work. I would have to close the door on myself while still in the closet to reset the switch, and I did not have the energy to swing doors back and forth all day.&lt;/p&gt;

&lt;h1 id=&quot;to-rectify-the-situation&quot;&gt;To Rectify the Situation&lt;/h1&gt;

&lt;p&gt;Bad puns aside, I decided I would go ahead and try to make an automatic light with the help of my Grandfather, &lt;a href=&quot;http://patents.justia.com/inventor/robert-s-kasimov&quot;&gt;Robert Kasimov&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;First there needed to be a power supply to power the sensor and the relay. This meant building a AC/DC converter to transform 120V AC to&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;12-15V @ 35mA DC for the Relay and&lt;/li&gt;
  &lt;li&gt;3.3-5V @ 800μA DC for the PIR Sensor (both from RadioShack)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;and for the record I don’t recommend getting anything at RadioShack: their selection is really very limited and at my location at least nothing is ever in order. This is the only circuit component place in Nashville though.&lt;/p&gt;

&lt;p&gt;Our work on Part I is as follows:&lt;/p&gt;

&lt;div class=&quot;article-img&quot;&gt;
    &lt;div class=&quot;center&quot;&gt;
    &lt;a href=&quot;/redeux//media/hdmd-acdc-converter/circuit.png&quot; target=&quot;_blank&quot;&gt;
        &lt;img src=&quot;/redeux//media/hdmd-acdc-converter/circuit.png&quot; alt=&quot;Here is the AC/DC Converter Circuit Schematic&quot; /&gt;
    &lt;/a&gt;
    &lt;/div&gt;
    
    &lt;blockquote style=&quot;border-left: 10px solid #D5D5D5;&quot;&gt;Here is the AC/DC Converter Circuit Schematic&lt;/blockquote&gt;
    
&lt;/div&gt;

&lt;p&gt;Now the first 1μF capacitor is there to limit the current of our circuit to be close to 35mA, it provides an impedance that results in a current I:&lt;/p&gt;

&lt;div class=&quot;article-img&quot;&gt;
    &lt;div class=&quot;center&quot;&gt;
    &lt;a href=&quot;/redeux//media/hdmd-acdc-converter/mathsForCapacitor.png&quot; target=&quot;_blank&quot;&gt;
        &lt;img src=&quot;/redeux//media/hdmd-acdc-converter/mathsForCapacitor.png&quot; alt=&quot;&quot; /&gt;
    &lt;/a&gt;
    &lt;/div&gt;
    
&lt;/div&gt;

&lt;p&gt;A capacitor is used instead of a 6 Watt resistor because it heats up significantly less. Another small 100Ω resistor is placed in series to act as a fuse, burning up if it ever goes beyond its power rating, which is 0.25 Watts. This gives a maximum current of:&lt;/p&gt;

&lt;div class=&quot;article-img&quot;&gt;
    &lt;div class=&quot;center&quot;&gt;
    &lt;a href=&quot;/redeux//media/hdmd-acdc-converter/mathsForFuse.png&quot; target=&quot;_blank&quot;&gt;
        &lt;img src=&quot;/redeux//media/hdmd-acdc-converter/mathsForFuse.png&quot; alt=&quot;&quot; /&gt;
    &lt;/a&gt;
    &lt;/div&gt;
    
&lt;/div&gt;

&lt;p&gt;A little solder and a lot of connections later:&lt;/p&gt;

&lt;div class=&quot;article-img&quot;&gt;
    &lt;div class=&quot;center&quot;&gt;
    &lt;a href=&quot;/redeux//media/hdmd-acdc-converter/cover.jpg&quot; target=&quot;_blank&quot;&gt;
        &lt;img src=&quot;/redeux//media/hdmd-acdc-converter/cover.jpg&quot; alt=&quot;The end product!&quot; /&gt;
    &lt;/a&gt;
    &lt;/div&gt;
    
    &lt;blockquote style=&quot;border-left: 10px solid #D5D5D5;&quot;&gt;The end product!&lt;/blockquote&gt;
    
&lt;/div&gt;

&lt;p&gt;Hey! Michael! That end product has more components than the schematic. What you tryin to pull?&lt;/p&gt;

&lt;p&gt;Well I didn’t have Zener diodes with enough voltage so I used one that is about 10V and another that is 3.3V. To bump the 3.3V to a safer 4.5V, I padded it with two normal diodes adding 0.6V each to the sum:&lt;/p&gt;

&lt;div class=&quot;article-img&quot;&gt;
    &lt;div class=&quot;center&quot;&gt;
    &lt;a href=&quot;/redeux//media/hdmd-acdc-converter/diode-hack.png&quot; target=&quot;_blank&quot;&gt;
        &lt;img src=&quot;/redeux//media/hdmd-acdc-converter/diode-hack.png&quot; alt=&quot;Diode Hack&quot; /&gt;
    &lt;/a&gt;
    &lt;/div&gt;
    
    &lt;blockquote style=&quot;border-left: 10px solid #D5D5D5;&quot;&gt;Diode Hack&lt;/blockquote&gt;
    
&lt;/div&gt;

&lt;p&gt;Finally, here is the PCB layout I made for the circuit, you can download the netlist data for the entire project &lt;a href=&quot;/media/hdmd-acdc-converter/ThreeBoards.cir&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;article-img&quot;&gt;
    &lt;div class=&quot;center&quot;&gt;
    &lt;a href=&quot;/redeux//media/hdmd-acdc-converter/acdc-board.png&quot; target=&quot;_blank&quot;&gt;
        &lt;img src=&quot;/redeux//media/hdmd-acdc-converter/acdc-board.png&quot; alt=&quot;Board is about 55x23 mm&quot; /&gt;
    &lt;/a&gt;
    &lt;/div&gt;
    
    &lt;blockquote style=&quot;border-left: 10px solid #D5D5D5;&quot;&gt;Board is about 55x23 mm&lt;/blockquote&gt;
    
&lt;/div&gt;</content><category term="circuits" /><summary type="html">The Idea</summary></entry><entry><title type="html">Mike India Kilo Echo</title><link href="http://icanteden.com/redeux//2014/07/20/phonetic-alphabet/" rel="alternate" type="text/html" title="Mike India Kilo Echo" /><published>2014-07-20T00:00:00-04:00</published><updated>2014-07-20T00:00:00-04:00</updated><id>http://icanteden.com/redeux//2014/07/20/phonetic-alphabet</id><content type="html" xml:base="http://icanteden.com/redeux//2014/07/20/phonetic-alphabet/">&lt;p&gt;My personal phonetic alphabet that I use to clarify all misunderstandings
when I try to spell tricky things like “Michael” over the phone:&lt;/p&gt;

&lt;table class=&quot;center&quot;&gt;
&lt;tr&gt;&lt;td&gt;A&lt;/td&gt;&lt;td&gt;Are&lt;/td&gt;&lt;td&gt;B&lt;/td&gt;&lt;td&gt;Bdellium&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;C&lt;/td&gt;&lt;td&gt;Czar&lt;/td&gt;&lt;td&gt;D&lt;/td&gt;&lt;td&gt;Djibouti or Richard&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;E&lt;/td&gt;&lt;td&gt;Euphoria&lt;/td&gt;&lt;td&gt;F&lt;/td&gt;&lt;td&gt;Fraise&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;G&lt;/td&gt;&lt;td&gt;Gnome&lt;/td&gt;&lt;td&gt;H&lt;/td&gt;&lt;td&gt;Heir&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;I&lt;/td&gt;&lt;td&gt;Illicit&lt;/td&gt;&lt;td&gt;J&lt;/td&gt;&lt;td&gt;Jalapeno&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;K&lt;/td&gt;&lt;td&gt;Knight&lt;/td&gt;&lt;td&gt;L&lt;/td&gt;&lt;td&gt;the silent L in Llama&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;M&lt;/td&gt;&lt;td&gt;Mnemonic&lt;/td&gt;&lt;td&gt;N&lt;/td&gt;&lt;td&gt;Nee&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;O&lt;/td&gt;&lt;td&gt;Ouija Board&lt;/td&gt;&lt;td&gt;P&lt;/td&gt;&lt;td&gt;Pterodactyl&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Q&lt;/td&gt;&lt;td&gt;Qat&lt;/td&gt;&lt;td&gt;R&lt;/td&gt;&lt;td&gt;R you sure?&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;S&lt;/td&gt;&lt;td&gt;Sea&lt;/td&gt;&lt;td&gt;T&lt;/td&gt;&lt;td&gt;Tsunami&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;U&lt;/td&gt;&lt;td&gt;Urushiol&lt;/td&gt;&lt;td&gt;V&lt;/td&gt;&lt;td&gt;'v' will!&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;W&lt;/td&gt;&lt;td&gt;Write&lt;/td&gt;&lt;td&gt;X&lt;/td&gt;&lt;td&gt;Xylophone&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;Y&lt;/td&gt;&lt;td&gt;You&lt;/td&gt;&lt;td&gt;Z&lt;/td&gt;&lt;td&gt;Zhou&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;</content><category term="funny" /><summary type="html">My personal phonetic alphabet that I use to clarify all misunderstandings
when I try to spell tricky things like “Michael” over the phone:</summary></entry><entry><title type="html">Natural Timing: A Portal 2 Map</title><link href="http://icanteden.com/redeux//2014/07/19/natural-timing/" rel="alternate" type="text/html" title="Natural Timing: A Portal 2 Map" /><published>2014-07-19T00:00:00-04:00</published><updated>2014-07-19T00:00:00-04:00</updated><id>http://icanteden.com/redeux//2014/07/19/natural-timing</id><content type="html" xml:base="http://icanteden.com/redeux//2014/07/19/natural-timing/">&lt;h2 id=&quot;available-for-download-here&quot;&gt;&lt;a href=&quot;http://steamcommunity.com/sharedfiles/filedetails/?id=278962722&quot;&gt;Available for download here.&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;‘Natural Timing’ is my first custom map for Portal 2,
it’s not very polished as it wasn’t done with the Hammer Editor,
but it is, I think, a very solid puzzle.&lt;/p&gt;

&lt;p&gt;Portal 2 is one of my favorite puzzle games, for those of you who don’t know,
it’s incredibly funny and just hard enough to make me feel smart. I highly recommend it.&lt;/p&gt;

&lt;p&gt;The map is basically a few experiments with ways to force a player to act quickly
without the use of timers. Along with this it also features a few tricks
that weren’t in the original Portal games (one cool one especially).&lt;/p&gt;

&lt;p&gt;I’ve solved it before, and so has one other friend, so please do not get
discouraged or worse yet: feel that it’s impossible. It might also be a
piece of cake, and we could be the dumb ones.&lt;/p&gt;

&lt;div class=&quot;article-img&quot;&gt;
    &lt;div class=&quot;center&quot;&gt;
    &lt;a href=&quot;/redeux//media/2014-07-19-natural-timing-portal2/Cake-2.png&quot; target=&quot;_blank&quot;&gt;
        &lt;img src=&quot;/redeux//media/2014-07-19-natural-timing-portal2/Cake-2.png&quot; alt=&quot;&quot; /&gt;
    &lt;/a&gt;
    &lt;/div&gt;
    
&lt;/div&gt;</content><category term="games" /><summary type="html">Available for download here.</summary></entry></feed>
